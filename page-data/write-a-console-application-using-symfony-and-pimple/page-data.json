{"componentChunkName":"component---src-templates-blog-post-js","path":"/write-a-console-application-using-symfony-and-pimple/","result":{"data":{"site":{"siteMetadata":{"title":"Luciano Mammino \"Loige\" - Cloud developer, entrepreneur, fighter, butterfly maker!","author":"Luciano Mammino","siteUrl":"https://loige.co","twitterProfile":"loige","disqusShortName":"loige"}},"markdownRemark":{"id":"8763da50-ef6d-571f-8c7a-c3454345d1f1","fileAbsolutePath":"/home/circleci/loige.co/content/posts/2014-03-15_write-a-console-application-using-symfony-and-pimple/index.md","excerpt":"In this article I will show you how to set up a stand alone command line application by using the Symfony Console component and Pimple…","timeToRead":8,"headings":[{"value":"Let’s start","depth":2},{"value":"Folder structure","depth":2},{"value":"The Greeter service","depth":2},{"value":"The GreetCommand","depth":2},{"value":"Ladies and gents, the Pimple container!","depth":2},{"value":"The bootstrap file","depth":2},{"value":"The executable console file","depth":2},{"value":"Conclusions","depth":2}],"html":"<p>In this article I will show you how to set up a stand alone command line application by using the <a href=\"https://github.com/symfony/console\">Symfony Console component</a> and <a href=\"http://pimple.sensiolabs.org/\">Pimple</a>.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 841px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35.9375%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsSAAALEgHS3X78AAABbElEQVQY02PIm74qo649sb47sb4rqrIlvKI5rLw5tLwlpLwlqLwloKzZv7TJr6TRu7jRs6jBvbDBpaDeOa/ONqfGsnkRQ2bLRF87Mw8HGx8HBw9bWy87Ozcra0dTMzsDQxt9QxsDQztDYzAysjc0stbVs9bTt9TScbd38GqZy1DYNsXd0MxJw9BO2sRJwQKIHOXMHORMLUV0TQW0rSUMzYV1TQW1TPg1TQS0DLhVjXjVNRlkknzi4qauYahom2wmqWwmrmotpm8raWgjYQBB5kANfJoWIjqG3Kp6HEr6nMpAZMClYsSjpsEgneIb17pkI0NT+xR9dmVDbjWgBAriVgVqAzIMedQQCGyzBqN0ik/c9LU7GLq6JqkxSAJdgoy0MBEjCOkwyxmwK6kxSGUFJCXklzIsX748MzIlKyo1MyolIxKE0iNS0iJSUsOTU8KTk8OSEkMTE0IS44JBKMg9zN3CzUHd0N7GzdjCEgAuv2qe6pYNPgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/4da6891d794f9bd7517f22537b287dbb/8d3d1/Screenshot_from_2014_03_15_03_19_53.webp 256w,\n/static/4da6891d794f9bd7517f22537b287dbb/354cf/Screenshot_from_2014_03_15_03_19_53.webp 512w,\n/static/4da6891d794f9bd7517f22537b287dbb/152d0/Screenshot_from_2014_03_15_03_19_53.webp 841w\"\n          sizes=\"(max-width: 841px) 100vw, 841px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/4da6891d794f9bd7517f22537b287dbb/85b06/Screenshot_from_2014_03_15_03_19_53.png 256w,\n/static/4da6891d794f9bd7517f22537b287dbb/bc282/Screenshot_from_2014_03_15_03_19_53.png 512w,\n/static/4da6891d794f9bd7517f22537b287dbb/20595/Screenshot_from_2014_03_15_03_19_53.png 841w\"\n          sizes=\"(max-width: 841px) 100vw, 841px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/4da6891d794f9bd7517f22537b287dbb/20595/Screenshot_from_2014_03_15_03_19_53.png\"\n          alt=\"Sample command line app\"\n          title=\"Sample command line app\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n    </span></p>\n<p>Writing console commands for Symfony (full stack framework) is easy and enjoyable. It helps a lot when you need to handle particular collateral tasks that are needed, in a way or another, to make your website running (processing and crunching data, make async requests, create reports, etc.).</p>\n<p>Anyway I discovered that writing stand alone command line applications using only the <a href=\"https://github.com/symfony/console\">Symfony/Console</a> component is a lot more easy and enjoyable and that a lot of famous command line applications uses it (<a href=\"https://getcomposer.org/\">Composer</a> and <a href=\"http://laravel.com/docs/commands\">Laravel/Artisan</a> just to name a few). Furthermore by using Symfony I became a great fan of the <em>Dependency Injection</em> and <em>Inversion of Control (IoC)</em> <a href=\"http://martinfowler.com/articles/injection.html\">design pattern</a> and, as my dependencies started to grow, I wanted to put some sort of <em>container</em> in my command line apps. I decided to go with <a href=\"http://pimple.sensiolabs.org/\">Pimple</a>: a really simple dependency injection container written by <a href=\"http://fabien.potencier.org/\">Fabien Potencier</a>, the notorious head behind the Symfony framework and Sensio.</p>\n<h2 id=\"lets-start\" style=\"position:relative;\"><a href=\"#lets-start\" aria-label=\"lets start permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Let’s start</h2>\n<p>I will demonstrate my approach by creating a simple “hello <em>$name</em>” command line application that will be able to count how many times you greet someone. You can find the whole code in a dedicated <a href=\"https://github.com/lmammino/SymfonyConsolePimple\">GitHub repository</a>.</p>\n<p>So we will be able to run</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">app/console greet Alice</code></pre></div>\n<p>and it will print out</p>\n<div class=\"gatsby-highlight\" data-language=\"none\"><pre class=\"language-none\"><code class=\"language-none\">Hello Alice\n(First time!)</code></pre></div>\n<p>Yes, intentionally simple! ;)</p>\n<p>Let’s start by creating our <em>composer.json</em> file. We will need the Symfony console and the Pimple packages. We also include the Symfony Yaml component as we will store data in a yaml file (obviously we could have been using json but I believe yaml is cooler :P).</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"lmammino/symfony-console-pimple\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"description\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"A sample Symfony Console app using Pimple\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"require\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"symfony/console\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"dev-master\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"pimple/pimple\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"dev-master\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"symfony/yaml\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"dev-master\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"license\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"MIT\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"authors\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Luciano Mammino\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"email\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"lmammino@oryzone.com\"</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"autoload\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"psr-4\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"LMammino\\\\ConsoleApp\\\\\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"src/\"</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Yes, let’s run <code>composer update</code> to download all the libraries.</p>\n<h2 id=\"folder-structure\" style=\"position:relative;\"><a href=\"#folder-structure\" aria-label=\"folder structure permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Folder structure</h2>\n<p>Let’s structure our code. We want to separate application and configuration code from the main source code. So we will end up with the following folder structure:</p>\n<ul>\n<li>app</li>\n<li>src</li>\n<li>vendors</li>\n</ul>\n<p>The <strong>app</strong> folder will contain our console executable file, a bootstrap file and a config folder. We will get into the details in a while.</p>\n<h2 id=\"the-greeter-service\" style=\"position:relative;\"><a href=\"#the-greeter-service\" aria-label=\"the greeter service permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>The Greeter service</h2>\n<p>Let’s just define our core service by Writing the <code>Greeter</code> class. This class defines the business logic of our greeting application.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n\n<span class=\"token keyword\">namespace</span> <span class=\"token package\">LMammino<span class=\"token punctuation\">\\</span>ConsoleApp</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">use</span> <span class=\"token package\">Symfony<span class=\"token punctuation\">\\</span>Component<span class=\"token punctuation\">\\</span>Yaml<span class=\"token punctuation\">\\</span>Yaml</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Greeter</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">/**\n     * @var string $file\n     */</span>\n    <span class=\"token keyword\">protected</span> <span class=\"token variable\">$file</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">/**\n     * @var array $greetings\n     */</span>\n    <span class=\"token keyword\">protected</span> <span class=\"token variable\">$greetings</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">/**\n     * Constructor\n     *\n     * @param string $file\n     */</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">file</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$file</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">file_exists</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">greetings</span> <span class=\"token operator\">=</span> Yaml<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span><span class=\"token function\">file_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">greetings</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">/**\n     * Destructor\n     */</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">__destruct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">file_put_contents</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">file</span><span class=\"token punctuation\">,</span> Yaml<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">dump</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">greetings</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">/**\n     * Builds the greeting for someone (you can yell on it if you want!)\n     *\n     * @param  string $name\n     * @param  bool   $yell wanna yell?\n     * @return string\n     */</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">greet</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$name</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$yell</span> <span class=\"token operator\">=</span> <span class=\"token boolean constant\">false</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$output</span> <span class=\"token operator\">=</span> <span class=\"token function\">sprintf</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'Hello %s'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$name</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$yell</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token variable\">$output</span> <span class=\"token operator\">=</span> <span class=\"token function\">strtoupper</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$output</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token variable\">$name</span> <span class=\"token operator\">=</span> <span class=\"token function\">strtolower</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$name</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">greetings</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$name</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">greetings</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$name</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">greetings</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$name</span><span class=\"token punctuation\">]</span><span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">return</span> <span class=\"token variable\">$output</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">/**\n     * Will tell you how many times you greet someone\n     *\n     * @param  string $name\n     * @return int\n     */</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">countGreetings</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$name</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$name</span> <span class=\"token operator\">=</span> <span class=\"token function\">strtolower</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$name</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">greetings</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$name</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">greetings</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$name</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></span></code></pre></div>\n<p>The class is really simple. The main methods are <code>greet</code> and <code>countGreetings</code> that allows you to build the greet string for someone and to count how many times you have greet someone.</p>\n<p>Note that this class needs to know on costruction which file to use to read and store the greetings count. This will be something we will configure through Pimple as a container parameter.</p>\n<h2 id=\"the-greetcommand\" style=\"position:relative;\"><a href=\"#the-greetcommand\" aria-label=\"the greetcommand permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>The GreetCommand</h2>\n<p>Now we have a service with the main business logic, let’s just write a Symfony command to run it:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n\n<span class=\"token keyword\">namespace</span> <span class=\"token package\">LMammino<span class=\"token punctuation\">\\</span>ConsoleApp<span class=\"token punctuation\">\\</span>Command</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">use</span> <span class=\"token package\">LMammino<span class=\"token punctuation\">\\</span>ConsoleApp<span class=\"token punctuation\">\\</span>Greeter</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> <span class=\"token package\">Symfony<span class=\"token punctuation\">\\</span>Component<span class=\"token punctuation\">\\</span>Console<span class=\"token punctuation\">\\</span>Command<span class=\"token punctuation\">\\</span>Command</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> <span class=\"token package\">Symfony<span class=\"token punctuation\">\\</span>Component<span class=\"token punctuation\">\\</span>Console<span class=\"token punctuation\">\\</span>Input<span class=\"token punctuation\">\\</span>InputArgument</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> <span class=\"token package\">Symfony<span class=\"token punctuation\">\\</span>Component<span class=\"token punctuation\">\\</span>Console<span class=\"token punctuation\">\\</span>Input<span class=\"token punctuation\">\\</span>InputInterface</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> <span class=\"token package\">Symfony<span class=\"token punctuation\">\\</span>Component<span class=\"token punctuation\">\\</span>Console<span class=\"token punctuation\">\\</span>Input<span class=\"token punctuation\">\\</span>InputOption</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> <span class=\"token package\">Symfony<span class=\"token punctuation\">\\</span>Component<span class=\"token punctuation\">\\</span>Console<span class=\"token punctuation\">\\</span>Output<span class=\"token punctuation\">\\</span>OutputInterface</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">GreetCommand</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Command</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">/**\n     * @var \\LMammino\\ConsoleApp\\Greeter $greeter\n     */</span>\n    <span class=\"token keyword\">protected</span> <span class=\"token variable\">$greeter</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">/**\n     * Constructor\n     *\n     * @param Greeter $greeter\n     */</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">__construct</span><span class=\"token punctuation\">(</span>Greeter <span class=\"token variable\">$greeter</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">parent</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">greeter</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$greeter</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">/**\n     * {@inheritDoc}\n     */</span>\n    <span class=\"token keyword\">protected</span> <span class=\"token keyword\">function</span> <span class=\"token function\">configure</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">setName</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'greet'</span><span class=\"token punctuation\">)</span>\n            <span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">setDescription</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'Greet someone'</span><span class=\"token punctuation\">)</span>\n            <span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">addArgument</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'name'</span><span class=\"token punctuation\">,</span> InputArgument<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token constant\">OPTIONAL</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'The name of the one you want to greet'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'World'</span><span class=\"token punctuation\">)</span>\n            <span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">addOption</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'yell'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'Y'</span><span class=\"token punctuation\">,</span> InputOption<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token constant\">VALUE_NONE</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'If set will scream out the greeting. Use with caution!'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">/**\n     * {@inheritDoc}\n     */</span>\n    <span class=\"token keyword\">protected</span> <span class=\"token keyword\">function</span> <span class=\"token function\">execute</span><span class=\"token punctuation\">(</span>InputInterface <span class=\"token variable\">$input</span><span class=\"token punctuation\">,</span> OutputInterface <span class=\"token variable\">$output</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$name</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$input</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">getArgument</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'name'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$yell</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$input</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">getOption</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'yell'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token variable\">$output</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">writeln</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">greeter</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">greet</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$name</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$yell</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">===</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$count</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">greeter</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">countGreetings</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$name</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token variable\">$output</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">writeln</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'(First time!)'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token variable\">$output</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">writeln</span><span class=\"token punctuation\">(</span><span class=\"token function\">sprintf</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'(%d times)'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$count</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></span></code></pre></div>\n<p>The command is totally self explainatory! It just defines the <em>greet</em> command offering a <em>name</em> argument and a <em>yell</em> option (both optional). The point here is that our command has a dependency on the <code>Greeter</code> class we wrote before. So we need to pass it on construction (or we need to configure our Pimple container to do so).</p>\n<h2 id=\"ladies-and-gents-the-pimple-container\" style=\"position:relative;\"><a href=\"#ladies-and-gents-the-pimple-container\" aria-label=\"ladies and gents the pimple container permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Ladies and gents, the Pimple container!</h2>\n<p>Finally it’s time to write our Pimple container. Before getting to the code let’s recap things a bit.\nWe have a parameter (the name of the greetings count file) and two services (the <code>Greeter</code> service and the <code>GreetCommand</code>).\nWe will create a <code>app/config/container.php</code> file to define our parameters and services with Pimple:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n\n<span class=\"token variable\">$c</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Pimple</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$c</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'parameters'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span>\n    <span class=\"token single-quoted-string string\">'greetings.file'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'greetings.yaml'</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$c</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'greeter'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\"><span class=\"token punctuation\">\\</span>LMammino<span class=\"token punctuation\">\\</span>ConsoleApp<span class=\"token punctuation\">\\</span>Greeter</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'parameters'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'greetings.file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$c</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'command.greet'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\"><span class=\"token punctuation\">\\</span>LMammino<span class=\"token punctuation\">\\</span>ConsoleApp<span class=\"token punctuation\">\\</span>Command<span class=\"token punctuation\">\\</span>GreetCommand</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'greeter'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$c</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'commands'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span>\n        <span class=\"token variable\">$c</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'command.greet'</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$c</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'application'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token variable\">$application</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\"><span class=\"token punctuation\">\\</span>Symfony<span class=\"token punctuation\">\\</span>Component<span class=\"token punctuation\">\\</span>Console<span class=\"token punctuation\">\\</span>Application</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$application</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">addCommands</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'commands'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token variable\">$application</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">return</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">;</span></span></code></pre></div>\n<p>If you were not familiar with Pimple you should have noticed the simple syntax of this container. We just need to create a Pimple instance and it acts like an array. In this “array” we put parameters as simple data (scalar or array values) and service definitions as functions that return instantiated services.\nLet’s check our definitions one by one:</p>\n<ul>\n<li><code>$c['parameters']</code> contains the applications parameters (in a more complex application with a lot of parameters you can load the values from an external configuration file)</li>\n<li><code>$c['greeter']</code> defines the construction of our <code>Greeter</code> service</li>\n<li><code>$c['command.greet']</code> defines the construction of our <em>greet</em> command</li>\n<li><code>$c['commands']</code> is an helper definition that returns an array with all the commands that we want to add in our application</li>\n<li><code>$c['application']</code> defines the creation of our command line application</li>\n</ul>\n<p>Ok, we are almost done. We just need to write our bootstrap file and our console executable file.</p>\n<h2 id=\"the-bootstrap-file\" style=\"position:relative;\"><a href=\"#the-bootstrap-file\" aria-label=\"the bootstrap file permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>The bootstrap file</h2>\n<p>The file <code>app/bootstrap.php</code> is used to load the composer autoloader class and our container:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n\n<span class=\"token function\">set_time_limit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">require</span> <span class=\"token constant\">__DIR__</span> <span class=\"token punctuation\">.</span> <span class=\"token single-quoted-string string\">'/../vendor/autoload.php'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$container</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">require</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__DIR__</span> <span class=\"token punctuation\">.</span> <span class=\"token single-quoted-string string\">'/config/container.php'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre></div>\n<p><code>set_time_limit(0)</code> ensures that our script will not be killed after a certain amount of seconds (if your <em>php.ini</em> wants so). It’s almost useless in this particular case (our command will run in a few milliseconds) but adding it in Php command line applications is a good practice (especially when you have to deal with long running tasks).</p>\n<h2 id=\"the-executable-console-file\" style=\"position:relative;\"><a href=\"#the-executable-console-file\" aria-label=\"the executable console file permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>The executable console file</h2>\n<p>The last step needed to make our application executable is to write the <code>app/console</code> file. This is a php file that can be executed from the command line (you need to <code>chmod +x</code> it).</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\">#!/usr/bin/env php\n<span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n\n<span class=\"token keyword\">require</span> <span class=\"token constant\">__DIR__</span> <span class=\"token punctuation\">.</span> <span class=\"token single-quoted-string string\">'/bootstrap.php'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$application</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$container</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'application'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$application</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre></div>\n<p>By using a container it just need to load our “application” service and call <code>run()</code> on it.</p>\n<p>Note that the first ”<a href=\"http://en.wikipedia.org/wiki/Shebang_%28Unix%29\">shebang</a>” line (<code>#!/usr/bin/env php</code>) allows us to run this file by calling <code>app/console</code> (so that you can avoid to call the php interpreter explicitly).</p>\n<h2 id=\"conclusions\" style=\"position:relative;\"><a href=\"#conclusions\" aria-label=\"conclusions permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Conclusions</h2>\n<p>This app is very simple and it will be easy to build even without adopting a container. Anyway I think this approach guarantees a good organization for your code and will became really useful when your command line application start to grow in terms of complexity.\nI recently had to build a command line app that uses Doctrine and JMS/Serializer (plus several other dependecies). I can say that adopting a container like Pimple helped me a lot to keep things organized and services decoupled.</p>\n<p>Just to make a final recap I think this approach guarantees several benefits:</p>\n<ul>\n<li>Write <strong>“container agnostic” commands</strong> (they does not know the container, but have only the required dependencies injected)</li>\n<li><strong>Attach new commands from configuration</strong>: you just need to add them to the <code>$container['commands']</code> array</li>\n<li>Help you a lot to write <strong>thin commands</strong> (yes, I think commands acts like controllers and they should be “thin” too), because you have a simple way to declare services and their dependencies and you are able to inject only the needed ones in every command</li>\n<li>Allow you to have <strong>parameters and configuration</strong> (useful when you have to enstablish a connection with a database or use external resources that needs configuration such as an external API)</li>\n</ul>\n<p>That should be all. Feel free to comment this post or to contribute to the <a href=\"https://github.com/lmammino/SymfonyConsolePimple\">sample app repository</a> if you feel that this approach can be tweaked.</p>\n<p><strong>UPDATE</strong> (March 16, 2014):<br>\n<a href=\"https://twitter.com/javiereguiluz\">Javier Egiluz</a>, great Symfony evangelist, pointed out that one of his command line applications, <a href=\"http://easybook-project.org/\">easybook</a>, uses the Symfony Console component in conjunction with Pimple. So if you want to have a look to a more complete and realistic (and complex :P) use case I really suggest you to have a look at the <a href=\"https://github.com/javiereguiluz/easybook\">easybook code base</a>.</p>\n<p>Have a nice weekend!</p>","frontmatter":{"title":"Write a console application using Symfony and Pimple","meta_description":null,"slug":"write-a-console-application-using-symfony-and-pimple","author":"Luciano Mammino","tags":["php","symfony","console","pimple"],"date":"March 15, 2014","dateISO":"2014-03-15T02:16:20.000Z","header_img":{"publicURL":"/static/91044114dc4bd9465a594a9032eb4924/write-a-console-application-using-symfony-and-pimple.png"},"fb_img":{"publicURL":"/static/04d3f8cfcc6dd310f92cbcfe058fe5d0/write-a-console-application-using-symfony-and-pimple-fb.png"},"tw_img":{"publicURL":"/static/230e077bb1c28f975d5cd4ff1ff03447/write-a-console-application-using-symfony-and-pimple-tw.png"}}}},"pageContext":{"tags":["php","symfony","console","pimple"],"slug":"write-a-console-application-using-symfony-and-pimple","previous":{"timeToRead":3,"excerpt":"Recently I had the need to run a twig template that uses the trans filter on my frontend using twig.js, a pure JavaScript port of twig written by the good Johannes Schmitt.\nThe JavaScript version does not handle all the functionalities offered by the original PHP version (even if it goes pretty close) and in particular it does not natively handle the trans filter. So, at first, I got a JavaScript runtime exception on my page when trying to use the template.\nLuckily enough the JavaScript version of twig is…","fields":{"slug":"integrating-twig-js-and-bazingajstranslationbundle"},"frontmatter":{"date":"28 February, 2014","title":"Integrating Twig.js and BazingaJsTranslationBundle","tags":["php","symfony","javascript","translation","twig"],"header_img":{"publicURL":"/static/c55fd49a6826ee1cf2f5094c5c5970d2/integrating-twig-js-and-bazingajstranslationbundle.png"}}},"next":{"timeToRead":2,"excerpt":"Few days ago I learned an interesting trick that allows you to reset the password on a MySql server. This trick is pretty useful in case you have lost (or you haven’t ever had) the password of your MySql root user. You just need to throw some commands at the console. Note that I am assuming you are using Ubuntu or some other Debian derivate. Otherwise the commands may change a bit (but not to much I believe).  1. Stop the mysql daemon 2. Disable the security checks The mysqld_safe command will essentially…","fields":{"slug":"reset-your-mysql-server-password"},"frontmatter":{"date":"30 March, 2014","title":"Reset your MySql server password","tags":["security","mysql","server"],"header_img":{"publicURL":"/static/8ecbcf4197f4bf2923cd233288a6171a/reset-your-mysql-server-password.png"}}},"similar":[{"slug":"6-rules-of-thumb-to-build-blazing-fast-web-applications","title":"6 Rules of thumb to build blazing fast web server applications","publishedAt":"25 July, 2015","score":2},{"slug":"symfony-edit-the-response-globally-using-the-kernel-response-event","title":"Symfony, edit the Response globally using the Kernel Response event","publishedAt":"21 February, 2015","score":2},{"slug":"transparent-pixel-response-with-symfony-how-to-track-email-opening","title":"Transparent pixel response with Symfony, how to track email opening","publishedAt":"13 June, 2014","score":2},{"slug":"integrating-twig-js-and-bazingajstranslationbundle","title":"Integrating Twig.js and BazingaJsTranslationBundle","publishedAt":"28 February, 2014","score":2},{"slug":"symfony-security-authentication-made-simple","title":"Symfony security: authentication made simple (well, maybe!)","publishedAt":"14 February, 2014","score":2}]}},"staticQueryHashes":[]}